(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))a(d);new MutationObserver(d=>{for(const o of d)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function n(d){const o={};return d.integrity&&(o.integrity=d.integrity),d.referrerPolicy&&(o.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?o.credentials="include":d.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(d){if(d.ep)return;d.ep=!0;const o=n(d);fetch(d.href,o)}})();const _=document.querySelector("#budgets");I();const q=document.querySelector("#budget_details"),D=document.getElementById("back__home"),S=document.querySelector("#budget_form"),P=document.querySelector("#budget_form .modal__card__header i"),w=document.querySelector("#budget_details .add__spent__btn"),L=document.querySelector("#budget_spent_form"),$=document.querySelector("#budget_spent_form .modal__card__header i"),E=document.getElementById("notifications"),N=document.querySelector("#budget_details .budget__card .icon"),l=document.getElementById("sort_spent"),B=document.getElementsByTagName("body")[0];O();function O(){window.matchMedia("(prefers=color-scheme : dark)").matches||(B.classList.add("dark"),document.getElementById("icon_dark_theme").classList.add("hidden"),document.getElementById("icon_light_theme").classList.remove("hidden"))}document.getElementById("theme_switch").addEventListener("click",e=>{B.classList.contains("dark")?(document.getElementById("icon_dark_theme").classList.remove("hidden"),document.getElementById("icon_light_theme").classList.add("hidden")):(document.getElementById("icon_dark_theme").classList.add("hidden"),document.getElementById("icon_light_theme").classList.remove("hidden")),B.classList.toggle("dark")});function I(){const t=i().map(n=>{const a=M(n);return`<div class="budget__card" data-budgetid="${n.id}">
        <h2 class="budget__name">${n.name_budget}</h2>
        <p class="budget__amount">${g(a)}</p>
        <p class="budget__total">Total ${g(n.total)}</p>
      </div>`}).concat('<button class="add__budget__btn">+</button>').join("");_.innerHTML=t,H()}function H(){const e=document.querySelectorAll("#budgets .budget__card"),t=document.querySelector("#budgets button");e.forEach(n=>{n.addEventListener("click",()=>{const a=n.getAttribute("data-budgetid");v(a),s(a,l.value),_.classList.toggle("hidden"),q.classList.toggle("hidden")})}),t.addEventListener("click",function(){C()})}function v(e){const t=h(e)??"",n=M(t);document.querySelector("#budget_details .budget__card").setAttribute("data-budgetid",e),document.querySelector("#budget_details .budget__card h2").innerText=t.name_budget,document.querySelector("#budget_details .budget__card .budget__amount").innerText=g(n),document.querySelector("#budget_details .budget__card .budget__total").innerText="Total "+g(t.total)}function s(e,t){var c;const n=((c=h(e))==null?void 0:c.pengeluaran)??[],[a,d]=t.split("|");F(n,a,d);const o=n.map(r=>`<div class="spent__item" data-spentid="${r.id}" >
          <div class="spent__item__description">
            <h4>${r.name_spent}</h4>
            <p>${r.spent_date}</p>
          </div>
          <div class="spent__item__price">
            <p>${g(r.spent_amount)}</p>
          </div>
       </div>`).join("");document.querySelector("#budget_details .spent").innerHTML=o,I(),v(e),document.querySelectorAll("#budget_details .spent .spent__item").forEach(r=>{r.addEventListener("click",()=>{J(r.getAttribute("data-spentid"),n)})})}document.getElementById("sort_spent").addEventListener("change",e=>{const t=document.querySelector("#budget_details .budget__card").getAttribute("data-budgetid");s(t,e.target.value)});function F(e,t,n){let a=0;do{a=0;for(let d=0;d<e.length-1;d++){const o=t=="spent_amount"?+e[d][t]:e[d][t],u=t=="spent_amount"?+e[d+1][t]:e[d+1][t];(n=="asc"&&o>u||n=="desc"&&o<u)&&([e[d],e[d+1]]=[e[d+1],e[d]],a++)}}while(a>0);return e}function A(){_.classList.toggle("hidden"),q.classList.toggle("hidden"),_.style.animation="slideLeft 500ms ease-in-out normal"}D.addEventListener("click",function(){A()});function C(){document.querySelector("#budget_form .modal__card__header h4").innerHTML="Tambah Budget",document.querySelector("#budget_details .budget__card").setAttribute("data-budgetid",null),document.querySelector("#budget_form .modal__footer button.danger").classList.add("hidden"),b(),S.classList.toggle("hidden")}function j(){const e=document.querySelector("#budget_details .budget__card").getAttribute("data-budgetid");document.querySelector("#budget_form .modal__card__header h4").innerHTML="Edit Budget";const t=document.querySelector("#budget_form .modal__footer button.danger");t.classList.remove("hidden"),t.onclick=()=>W(e);const n=h(e);document.getElementById("name_budget").value=n.name_budget,document.getElementById("total").value=n.total,S.classList.toggle("hidden")}N.addEventListener("click",()=>{j()});P.addEventListener("click",()=>{f()});function f(){S.classList.toggle("hidden")}function x(){document.querySelector("#budget_spent_form .modal__card__header h4").innerHTML="Tambah Pengeluaran",document.querySelector("#budget_spent_form .modal__footer button.danger").classList.add("hidden"),b(),L.classList.toggle("hidden")}function J(e,t){document.querySelector("#budget_spent_form .modal__card__header h4").innerHTML="Edit Pengeluaran";const n=document.querySelector("#budget_spent_form .modal__footer button.danger");n.classList.remove("hidden"),n.onclick=()=>z(e);const a=t.filter(d=>d.id==e)[0];document.getElementById("id_spent").value=e,document.getElementById("name_spent").value=a.name_spent,document.getElementById("spent_date").value=a.spent_date,document.getElementById("spent_amount").value=a.spent_amount,L.classList.toggle("hidden")}w.addEventListener("click",function(){x()});$.addEventListener("click",function(){p()});function p(){L.classList.toggle("hidden")}function b(){document.querySelectorAll("form input").forEach(e=>{e.value=""})}function T(e){return Object.fromEntries(e.entries())}function i(){return JSON.parse(localStorage.getItem("budgets"))??[]}function h(e){return i().filter(n=>n.id==e)[0]}function k(){return new Date().getTime()}function m(e){localStorage.setItem("budgets",JSON.stringify(e))}function R(e){const t=i(),n={id:k(),...e};t.push(n),m(t)}function V(e,t){const n=i(),a=n==null?void 0:n.map(d=>d.id==e?{id:e,...t,pengeluaran:d.pengeluaran}:d);m(a)}function W(e){const t=i();if(confirm("Apakah ingin mengahapus data bugdet?")){const a=t.filter(d=>d.id!=e);m(a),s(e,l.value),y("✔ Budget berhasil dihapus"),A(),f()}else f()}document.querySelector("#budget_form form").addEventListener("submit",e=>{e.preventDefault();const t=T(new FormData(e.target)),n=document.querySelector("#budget_details .budget__card").getAttribute("data-budgetid");n!=="null"?(V(n,t),v(n)):R(t),f(),b(),y(`✔ Budget ${t.name_budget} berhasil disimpan!`),s(n,l.value)});function K(e){const t=document.querySelector("#budget_details .budget__card").getAttribute("data-budgetid"),n=h(t),a=n.pengeluaran??[],d={...n,pengeluaran:[...a,{id:k(),...e}]},u=i().map(c=>c.id==t?d:c);m(u),s(t,l.value)}function U(e,t){const n=document.querySelector("#budget_details .budget__card").getAttribute("data-budgetid"),d=i().map(o=>{var u;if(o.id==n){const c=(u=o==null?void 0:o.pengeluaran)==null?void 0:u.map(r=>r.id==e?{...t,id:r.id}:r);return{...o,pengeluaran:c}}return o});m(d),s(n,l.value)}function z(e){const t=document.querySelector("#budget_details .budget__card").getAttribute("data-budgetid"),n=i();if(confirm("Apakah anda ingin menghapus pengeluaran")){const d=n.map(o=>{var u;return o.id==t?{...o,pengeluaran:(u=o==null?void 0:o.pengeluaran)==null?void 0:u.filter(c=>c.id!=e)}:o});m(d),s(t,l.value),y("✔ Pengeluaran berhasil dihapus"),p()}else p()}document.querySelector("#budget_spent_form form").addEventListener("submit",e=>{e.preventDefault();const t=T(new FormData(e.target)),n=document.getElementById("id_spent").value??null;n?U(n,t):K(t),p(),y(`✔ Pengeluaran ${t.name_spent} berhasil disimpan`),b()});function y(e){const t=document.createElement("div");t.innerText=e,t.classList.add("notification"),E.appendChild(t),setTimeout(()=>{t.classList.add("out"),setTimeout(()=>{E.removeChild(t)},500)},4e3)}function M(e){if(!e||!e.pengeluaran)return+(e==null?void 0:e.total)||0;const t=e.pengeluaran.reduce((n,a)=>n+ +a.spent_amount,0);return+e.total-t}function g(e){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",maximumFractionDigits:0}).format(e)}
